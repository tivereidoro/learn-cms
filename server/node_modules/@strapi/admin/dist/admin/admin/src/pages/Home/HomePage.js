'use strict';

var jsxRuntime = require('react/jsx-runtime');
var React = require('react');
var designSystem = require('@strapi/design-system');
var icons = require('@strapi/icons');
var reactIntl = require('react-intl');
var Layout = require('../../components/Layouts/Layout.js');
var PageHelpers = require('../../components/PageHelpers.js');
var WidgetHelpers = require('../../components/WidgetHelpers.js');
require('../../services/admin.js');
var useEnterprise = require('../../hooks/useEnterprise.js');
var Auth = require('../../features/Auth.js');
var StrapiApp = require('../../features/StrapiApp.js');
var ContentManagerWidgets = require('./components/ContentManagerWidgets.js');
var GuidedTour = require('./components/GuidedTour.js');

function _interopNamespaceDefault(e) {
  var n = Object.create(null);
  if (e) {
    Object.keys(e).forEach(function (k) {
      if (k !== 'default') {
        var d = Object.getOwnPropertyDescriptor(e, k);
        Object.defineProperty(n, k, d.get ? d : {
          enumerable: true,
          get: function () { return e[k]; }
        });
      }
    });
  }
  n.default = e;
  return Object.freeze(n);
}

var React__namespace = /*#__PURE__*/_interopNamespaceDefault(React);

const WidgetRoot = ({ title, icon = icons.PuzzlePiece, children })=>{
    const { formatMessage } = reactIntl.useIntl();
    const id = React__namespace.useId();
    const Icon = icon;
    return /*#__PURE__*/ jsxRuntime.jsxs(designSystem.Flex, {
        width: "100%",
        hasRadius: true,
        direction: "column",
        alignItems: "flex-start",
        background: "neutral0",
        borderColor: "neutral150",
        shadow: "tableShadow",
        tag: "section",
        gap: 4,
        padding: 6,
        "aria-labelledby": id,
        children: [
            /*#__PURE__*/ jsxRuntime.jsxs(designSystem.Flex, {
                direction: "row",
                alignItems: "center",
                gap: 2,
                tag: "header",
                children: [
                    /*#__PURE__*/ jsxRuntime.jsx(Icon, {
                        fill: "neutral500",
                        "aria-hidden": true
                    }),
                    /*#__PURE__*/ jsxRuntime.jsx(designSystem.Typography, {
                        textColor: "neutral500",
                        variant: "sigma",
                        tag: "h2",
                        id: id,
                        children: formatMessage(title)
                    })
                ]
            }),
            /*#__PURE__*/ jsxRuntime.jsx(designSystem.Box, {
                width: "100%",
                height: "261px",
                overflow: "auto",
                tag: "main",
                children: children
            })
        ]
    });
};
/* -------------------------------------------------------------------------------------------------
 * UnstableHomePageCe
 * -----------------------------------------------------------------------------------------------*/ const WidgetComponent = ({ component })=>{
    const [loadedComponent, setLoadedComponent] = React__namespace.useState(null);
    React__namespace.useEffect(()=>{
        const loadComponent = async ()=>{
            const resolvedComponent = await component();
            setLoadedComponent(()=>resolvedComponent);
        };
        loadComponent();
    }, [
        component
    ]);
    const Component = loadedComponent;
    if (!Component) {
        return /*#__PURE__*/ jsxRuntime.jsx(WidgetHelpers.Widget.Loading, {});
    }
    return /*#__PURE__*/ jsxRuntime.jsx(Component, {});
};
const UnstableHomePageCe = ()=>{
    const { formatMessage } = reactIntl.useIntl();
    const user = Auth.useAuth('HomePageCE', (state)=>state.user);
    const displayName = user?.firstname ?? user?.username ?? user?.email;
    const getAllWidgets = StrapiApp.useStrapiApp('UnstableHomepageCe', (state)=>state.widgets.getAll);
    return /*#__PURE__*/ jsxRuntime.jsxs(designSystem.Main, {
        children: [
            /*#__PURE__*/ jsxRuntime.jsx(PageHelpers.Page.Title, {
                children: formatMessage({
                    id: 'HomePage.head.title',
                    defaultMessage: 'Homepage'
                })
            }),
            /*#__PURE__*/ jsxRuntime.jsx(Layout.Layouts.Header, {
                title: formatMessage({
                    id: 'HomePage.header.title',
                    defaultMessage: 'Hello {name}'
                }, {
                    name: displayName
                }),
                subtitle: formatMessage({
                    id: 'HomePage.header.subtitle',
                    defaultMessage: 'Welcome to your administration panel'
                })
            }),
            /*#__PURE__*/ jsxRuntime.jsx(Layout.Layouts.Content, {
                children: /*#__PURE__*/ jsxRuntime.jsxs(designSystem.Flex, {
                    direction: "column",
                    alignItems: "stretch",
                    gap: 8,
                    paddingBottom: 10,
                    children: [
                        /*#__PURE__*/ jsxRuntime.jsx(GuidedTour.GuidedTour, {}),
                        /*#__PURE__*/ jsxRuntime.jsx(designSystem.Grid.Root, {
                            gap: 5,
                            children: getAllWidgets().map((widget)=>{
                                return /*#__PURE__*/ jsxRuntime.jsx(designSystem.Grid.Item, {
                                    col: 6,
                                    s: 12,
                                    children: /*#__PURE__*/ jsxRuntime.jsx(WidgetRoot, {
                                        title: widget.title,
                                        icon: widget.icon,
                                        children: /*#__PURE__*/ jsxRuntime.jsx(WidgetComponent, {
                                            component: widget.component
                                        })
                                    })
                                }, widget.uid);
                            })
                        })
                    ]
                })
            })
        ]
    });
};
/* -------------------------------------------------------------------------------------------------
 * HomePageCE
 * -----------------------------------------------------------------------------------------------*/ const HomePageCE = ()=>{
    const { formatMessage } = reactIntl.useIntl();
    const user = Auth.useAuth('HomePageCE', (state)=>state.user);
    const displayName = user?.firstname ?? user?.username ?? user?.email;
    if (window.strapi.future.isEnabled('unstableWidgetsApi')) {
        return /*#__PURE__*/ jsxRuntime.jsx(UnstableHomePageCe, {});
    }
    return /*#__PURE__*/ jsxRuntime.jsxs(designSystem.Main, {
        children: [
            /*#__PURE__*/ jsxRuntime.jsx(PageHelpers.Page.Title, {
                children: formatMessage({
                    id: 'HomePage.head.title',
                    defaultMessage: 'Homepage'
                })
            }),
            /*#__PURE__*/ jsxRuntime.jsx(Layout.Layouts.Header, {
                title: formatMessage({
                    id: 'HomePage.header.title',
                    defaultMessage: 'Hello {name}'
                }, {
                    name: displayName
                }),
                subtitle: formatMessage({
                    id: 'HomePage.header.subtitle',
                    defaultMessage: 'Welcome to your administration panel'
                })
            }),
            /*#__PURE__*/ jsxRuntime.jsx(Layout.Layouts.Content, {
                children: /*#__PURE__*/ jsxRuntime.jsxs(designSystem.Flex, {
                    direction: "column",
                    alignItems: "stretch",
                    gap: 8,
                    paddingBottom: 10,
                    children: [
                        /*#__PURE__*/ jsxRuntime.jsx(GuidedTour.GuidedTour, {}),
                        /*#__PURE__*/ jsxRuntime.jsxs(designSystem.Grid.Root, {
                            gap: 5,
                            children: [
                                /*#__PURE__*/ jsxRuntime.jsx(designSystem.Grid.Item, {
                                    col: 6,
                                    s: 12,
                                    children: /*#__PURE__*/ jsxRuntime.jsx(WidgetRoot, {
                                        title: {
                                            id: 'content-manager.widget.last-edited.title',
                                            defaultMessage: 'Last edited entries'
                                        },
                                        icon: icons.Pencil,
                                        children: /*#__PURE__*/ jsxRuntime.jsx(ContentManagerWidgets.LastEditedWidget, {})
                                    })
                                }),
                                /*#__PURE__*/ jsxRuntime.jsx(designSystem.Grid.Item, {
                                    col: 6,
                                    s: 12,
                                    children: /*#__PURE__*/ jsxRuntime.jsx(WidgetRoot, {
                                        title: {
                                            id: 'content-manager.widget.last-published.title',
                                            defaultMessage: 'Last published entries'
                                        },
                                        icon: icons.CheckCircle,
                                        children: /*#__PURE__*/ jsxRuntime.jsx(ContentManagerWidgets.LastPublishedWidget, {})
                                    })
                                })
                            ]
                        })
                    ]
                })
            })
        ]
    });
};
/* -------------------------------------------------------------------------------------------------
 * HomePage
 * -----------------------------------------------------------------------------------------------*/ const HomePage = ()=>{
    const Page = useEnterprise.useEnterprise(HomePageCE, // eslint-disable-next-line import/no-cycle
    async ()=>(await Promise.resolve().then(function () { return require('../../../../ee/admin/src/pages/HomePage.js'); })).HomePageEE);
    // block rendering until the EE component is fully loaded
    if (!Page) {
        return null;
    }
    return /*#__PURE__*/ jsxRuntime.jsx(Page, {});
};

exports.HomePage = HomePage;
exports.HomePageCE = HomePageCE;
exports.WidgetRoot = WidgetRoot;
//# sourceMappingURL=HomePage.js.map
